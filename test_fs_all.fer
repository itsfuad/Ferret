import "std/io";
import "std/fs";

fn main() {
    io::Println("=== Testing fs module ===\n");
    
    // 1. Test Exists on non-existent file
    io::Println("1. Testing Exists on non-existent file:");
    if fs::Exists("nonexistent_file_12345.txt") {
        io::Println("   FAIL: Exists returned true for non-existent file");
    } else {
        io::Println("   PASS: Exists returned false for non-existent file");
    }
    
    // 2. Test WriteFile
    io::Println("\n2. Testing WriteFile:");
    fs::WriteFile("test_fs.txt", "Hello from Ferret!") catch e {
        io::Println("   FAIL: WriteFile error: " + e);
        return;
    };
    io::Println("   PASS: WriteFile succeeded");
    
    // 3. Test Exists on existing file
    io::Println("\n3. Testing Exists on existing file:");
    if fs::Exists("test_fs.txt") {
        io::Println("   PASS: Exists returned true for existing file");
    } else {
        io::Println("   FAIL: Exists returned false for existing file");
    }
    
    // 4. Test ReadFile
    io::Println("\n4. Testing ReadFile:");
    let content := fs::ReadFile("test_fs.txt") catch e {
        io::Println("   FAIL: ReadFile error: " + e);
        return;
    };
    if content == "Hello from Ferret!" {
        io::Println("   PASS: ReadFile content matches");
    } else {
        io::Println("   FAIL: ReadFile content mismatch: " + content);
    }
    
    // 5. Test AppendFile
    io::Println("\n5. Testing AppendFile:");
    fs::AppendFile("test_fs.txt", " Appended!") catch e {
        io::Println("   FAIL: AppendFile error: " + e);
        return;
    };
    let content2 := fs::ReadFile("test_fs.txt") catch e {
        io::Println("   FAIL: ReadFile after append error: " + e);
        return;
    };
    if content2 == "Hello from Ferret! Appended!" {
        io::Println("   PASS: AppendFile content matches");
    } else {
        io::Println("   FAIL: AppendFile content mismatch: " + content2);
    }
    
    // 6. Test Size
    io::Println("\n6. Testing Size:");
    let size := fs::Size("test_fs.txt") catch e {
        io::Println("   FAIL: Size error: " + e);
        return;
    };
    io::Println("   File size: " + size);
    if size == 28 {
        io::Println("   PASS: Size matches expected (28)");
    } else {
        io::Println("   INFO: Size is " + size + " (expected 28)");
    }
    
    // 7. Test Remove
    io::Println("\n7. Testing Remove:");
    fs::Remove("test_fs.txt") catch e {
        io::Println("   FAIL: Remove error: " + e);
        return;
    };
    io::Println("   PASS: Remove succeeded");
    
    // 8. Verify file is gone
    io::Println("\n8. Verifying file removed:");
    if fs::Exists("test_fs.txt") {
        io::Println("   FAIL: File still exists after remove");
    } else {
        io::Println("   PASS: File no longer exists");
    }
    
    // 9. Test path utilities
    io::Println("\n9. Testing path utilities:");
    let joined := fs::Join("folder", "file.txt");
    io::Println("   Join('folder', 'file.txt') = " + joined);
    
    let ext := fs::Ext("document.txt");
    io::Println("   Ext('document.txt') = " + ext);
    
    let base := fs::Base("/path/to/file.txt");
    io::Println("   Base('/path/to/file.txt') = " + base);
    
    let dir := fs::Dir("/path/to/file.txt");
    io::Println("   Dir('/path/to/file.txt') = " + dir);
    
    // 10. Test Cwd
    io::Println("\n10. Testing Cwd:");
    let cwd := fs::Cwd() catch e {
        io::Println("   FAIL: Cwd error: " + e);
        return;
    };
    io::Println("   Current directory: " + cwd);
    
    io::Println("\n=== All tests completed ===");
}
